<app-public-navbar></app-public-navbar>

<div class="min-h-screen flex items-center justify-center relative overflow-hidden">
  <!-- Animated Background like hero section -->
  <div class="absolute inset-0 -z-10">
    <div class="absolute inset-0 bg-gradient-to-br from-primary to-primary-dark animate-gradient"></div>
    <div class="absolute top-0 left-0 w-full h-full overflow-hidden">
      <!-- Floating Icons Animation -->
      <div class="absolute w-full h-full">
        <!-- Driving School Related Icons -->
        <div class="absolute text-4xl opacity-80 left-[15%] top-[20%] emoji-float-1 drop-shadow-xl">
          <fa-icon [icon]="faCar" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-4xl opacity-80 left-[75%] top-[15%] emoji-float-2 drop-shadow-xl">
          <fa-icon [icon]="faKey" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-4xl opacity-80 left-[35%] top-[75%] emoji-float-3 drop-shadow-xl">
          <fa-icon [icon]="faMobile" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-4xl opacity-80 left-[85%] top-[65%] emoji-float-4 drop-shadow-xl">
          <fa-icon [icon]="faChartBar" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-4xl opacity-80 left-[25%] top-[40%] emoji-float-5 drop-shadow-xl">
          <fa-icon [icon]="faClock" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-4xl opacity-80 left-[65%] top-[30%] emoji-float-6 drop-shadow-xl">
          <fa-icon [icon]="faPen" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-4xl opacity-80 left-[10%] top-[60%] emoji-float-7 drop-shadow-xl">
          <fa-icon [icon]="faRoad" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-4xl opacity-80 left-[50%] top-[10%] emoji-float-8 drop-shadow-xl">
          <fa-icon [icon]="faTrafficLight" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-4xl opacity-80 left-[90%] top-[80%] emoji-float-9 drop-shadow-xl">
          <fa-icon [icon]="faCalendar" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-4xl opacity-80 left-[40%] top-[55%] emoji-float-10 drop-shadow-xl">
          <fa-icon [icon]="faBriefcase" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-4xl opacity-80 left-[60%] top-[85%] emoji-float-11 drop-shadow-xl">
          <fa-icon [icon]="faChartLine" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-4xl opacity-80 left-[30%] top-[25%] emoji-float-12 drop-shadow-xl">
          <fa-icon [icon]="faFlag" class="text-white"></fa-icon>
        </div>

        <!-- Second layer of smaller icons -->
        <div class="absolute text-2xl opacity-60 left-[22%] top-[33%] emoji-float-13 drop-shadow-xl">
          <fa-icon [icon]="faSync" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-2xl opacity-60 left-[45%] top-[68%] emoji-float-14 drop-shadow-xl">
          <fa-icon [icon]="faPhone" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-2xl opacity-60 left-[78%] top-[42%] emoji-float-15 drop-shadow-xl">
          <fa-icon [icon]="faClipboard" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-2xl opacity-60 left-[12%] top-[88%] emoji-float-16 drop-shadow-xl">
          <fa-icon [icon]="faCheckCircle" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-2xl opacity-60 left-[55%] top-[22%] emoji-float-17 drop-shadow-xl">
          <fa-icon [icon]="faStar" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-2xl opacity-60 left-[88%] top-[38%] emoji-float-18 drop-shadow-xl">
          <fa-icon [icon]="faSearch" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-2xl opacity-60 left-[32%] top-[92%] emoji-float-19 drop-shadow-xl">
          <fa-icon [icon]="faLaptop" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-2xl opacity-60 left-[72%] top-[78%] emoji-float-20 drop-shadow-xl">
          <fa-icon [icon]="faMoneyBill" class="text-white"></fa-icon>
        </div>

        <!-- Additional icons -->
        <div class="absolute text-3xl opacity-70 left-[18%] top-[72%] emoji-float-21 drop-shadow-xl">
          <fa-icon [icon]="faGraduationCap" class="text-white"></fa-icon>
        </div>
        <div class="absolute text-3xl opacity-70 left-[82%] top-[25%] emoji-float-22 drop-shadow-xl">
          <fa-icon [icon]="faMapMarker" class="text-white"></fa-icon>
        </div>

        <!-- Shimmer particles (smaller white dots) -->
        <div class="absolute w-[4px] h-[4px] rounded-full bg-white/40 left-[18%] top-[27%] shimmer-particle-1"></div>
        <div class="absolute w-[3px] h-[3px] rounded-full bg-white/30 left-[47%] top-[63%] shimmer-particle-2"></div>
        <div class="absolute w-[5px] h-[5px] rounded-full bg-white/50 left-[82%] top-[37%] shimmer-particle-3"></div>
        <div class="absolute w-[4px] h-[4px] rounded-full bg-white/40 left-[27%] top-[52%] shimmer-particle-4"></div>
        <div class="absolute w-[3px] h-[3px] rounded-full bg-white/30 left-[67%] top-[18%] shimmer-particle-5"></div>
        <div class="absolute w-[5px] h-[5px] rounded-full bg-white/50 left-[37%] top-[83%] shimmer-particle-6"></div>
        <div class="absolute w-[4px] h-[4px] rounded-full bg-white/40 left-[92%] top-[72%] shimmer-particle-7"></div>
        <div class="absolute w-[3px] h-[3px] rounded-full bg-white/30 left-[12%] top-[47%] shimmer-particle-8"></div>
        <div class="absolute w-[5px] h-[5px] rounded-full bg-white/50 left-[52%] top-[33%] shimmer-particle-9"></div>
        <div class="absolute w-[4px] h-[4px] rounded-full bg-white/40 left-[77%] top-[57%] shimmer-particle-10"></div>
      </div>

      <!-- Shimmering effect -->
      <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-b from-white/5 to-transparent"></div>
    </div>
  </div>

  <!-- Auth Form Container with glass card effect like in hero section -->
  <div class="max-w-md w-full backdrop-blur-md bg-white/40 rounded-2xl p-8 shadow-xl border border-white/30 z-10 mx-4 glass-card">
    <div class="text-center mb-6">
      <img src="assets/images/logo/logo-extended-plus.png" alt="DriveFlow Logo" class="h-auto w-60 mx-auto mb-6">
      <h2 class="text-2xl font-bold text-dark">Sign In</h2>
    </div>

    <!-- Error message -->
    <div *ngIf="errorMessage" class="bg-red-100/70 backdrop-blur-sm border border-red-400 text-red-700 px-4 py-3 rounded mb-4" role="alert">
      <span class="block sm:inline">{{ errorMessage }}</span>
    </div>

    <!-- Already Logged In -->
    <div *ngIf="isLoggedIn" class="text-center">
      <p class="mb-4 text-dark">You are already logged in to your account.</p>
      <div class="flex flex-col space-y-3">
        <a routerLink="/dashboard" class="px-4 py-2 text-white bg-primary font-bold rounded-lg hover:bg-primary-dark transition-all duration-300">
          Go to Dashboard
        </a>
        <button (click)="handleLogout()" class="px-4 py-2 text-white bg-red-600 font-bold rounded-lg hover:bg-red-700 transition-all duration-300">
          Log Out
        </button>
      </div>
    </div>

    <!-- LOGIN FORM -->
    <form *ngIf="!isLoggedIn" [formGroup]="loginForm" (ngSubmit)="onLogin()" class="space-y-6">
      <div>
        <label for="email" class="block text-sm font-medium text-dark mb-1">Email</label>
        <input
          type="email"
          id="email"
          formControlName="email"
          class="w-full px-3 py-2 border border-white/30 bg-white/60 backdrop-blur-sm rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary glow-input"
          placeholder="your@email.com"
          [ngClass]="{'border-red-500': loginForm.get('email')?.invalid && loginForm.get('email')?.touched}"
          required>
        <div *ngIf="loginForm.get('email')?.invalid && loginForm.get('email')?.touched" class="text-sm text-red-600 mt-1">
          <div *ngIf="loginForm.get('email')?.errors?.['required']">Email is required</div>
          <div *ngIf="loginForm.get('email')?.errors?.['email']">Please enter a valid email</div>
        </div>
      </div>

      <div>
        <label for="password" class="block text-sm font-medium text-dark mb-1">Password</label>
        <div class="relative">
          <input
            [type]="passwordVisible ? 'text' : 'password'"
            id="password"
            formControlName="password"
            class="w-full px-3 py-2 border border-white/30 bg-white/60 backdrop-blur-sm rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary glow-input"
            [ngClass]="{'border-red-500': loginForm.get('password')?.invalid && loginForm.get('password')?.touched}"
            required>
          <button
            type="button"
            class="absolute inset-y-0 right-0 pr-3 flex items-center text-sm text-gray-600 password-toggle-btn"
            (click)="togglePasswordVisibility()"
            aria-label="Toggle password visibility">
            <fa-icon [icon]="passwordVisible ? faEyeSlash : faEye"></fa-icon>
          </button>
        </div>
        <div *ngIf="loginForm.get('password')?.invalid && loginForm.get('password')?.touched" class="text-sm text-red-600 mt-1">
          <div *ngIf="loginForm.get('password')?.errors?.['required']">Password is required</div>
        </div>
      </div>

        <div class="flex items-center">
          <input
            id="remember-me"
            name="remember-me"
            type="checkbox"
          class="h-4 w-4 text-primary focus:ring-primary border-white/30 bg-white/60 rounded">
        <label for="remember-me" class="ml-2 block text-sm text-dark">
          Remember me
          </label>
      </div>

      <div>
        <button
          type="submit"
          [disabled]="isLoading || loginForm.invalid"
          class="w-full py-2 px-4 border border-transparent rounded-md shadow-xl text-sm font-medium text-white bg-primary-dark hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:hover:scale-100 signin-btn">
          <span *ngIf="isLoading">Processing...</span>
          <span *ngIf="!isLoading">Sign In</span>
        </button>
      </div>
    </form>
  </div>
</div>
